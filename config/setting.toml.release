# cocoro_ghost 起動設定

# CocoroGhost API の待受ポート
cocoro_ghost_port = 55601

token = "cocoro_token"

# Web UI 自動ログイン（Cookieセッションをトークン無しで自動発行）
# - true: Web UI は起動時に自動ログイン（ログイン画面を基本的に使わない）
# - false: 従来通り token を入力してログイン
web_auto_login_enabled = true

# ログレベル: DEBUG=詳細表示, INFO=通常表示, WARNING=警告以上表示, ERROR=エラーのみ表示
log_level = "DEBUG"
#log_level = "INFO"
#log_level = "WARNING"
#log_level = "ERROR"

# LLM送受信ログレベル: DEBUG=内容表示, INFO=送受信事実のみ, OFF=出力なし
#llm_log_level = "INFO"
llm_log_level = "DEBUG"
#llm_log_level = "OFF"

# LLMのタイムアウト（秒）
# - llm_timeout_seconds: 非ストリーム（JSON生成など）の上限
# - llm_stream_timeout_seconds: ストリーム開始までの上限
llm_timeout_seconds = 30
llm_stream_timeout_seconds = 60

# 画像要約（chat/notification/meta-request）: 1枚あたりの最大文字数
# - 大きいほど「画像の材料」が増えるが、後段のプロンプトが膨らみ体感と安定性が悪化しやすい
# - 推奨: 200〜600（既定: 400）
image_summary_max_chars = 400

# 記憶検索（SearchResultPack）の候補数上限
# - 大きいほど取りこぼしが減るが、検索候補の選別が遅くなる
# - 推奨: 40〜120（既定: 60）
retrieval_max_candidates = 60

# 記憶検索（SearchResultPack）: 候補の割合配分（retrieval_max_candidates のX%）
# - 目的: trigram/context/vector など「増えやすい経路」が席を独占して体感が悪化するのを抑える
# - 合計が100未満でもOK（余りは元の順位順で埋める）
# - event_affect は候補を食い過ぎやすいので最大割合だけを設ける（最低件数は保証しない）
#   - 例: retrieval_max_candidates=60, retrieval_event_affect_max_percent=5 → event_affect は最大3件まで
#   - 0 にすると event_affect は候補に入らない
#
# 探索枠（ひらめき用）:
# - ユーザーが期間指定しなくても、全期間ベクトル由来の候補を少量だけ毎ターン混ぜる
# - 例: retrieval_max_candidates=60, retrieval_explore_global_vector_percent=5 → 探索枠は3件
retrieval_explore_global_vector_percent = 5
retrieval_event_affect_max_percent = 5

# associative_recent（普段の雑談/直近の流れ）
# - state: 事実/タスクなど（会話の安定に効くので確保）
# - multi_hit: 複数経路一致（取りこぼし防止の核）
# - vector_only: 意味近傍（最近寄り。語が一致しない関連の拾い上げ）
# - context_only: 文脈維持（返信連鎖/スレッド/リンク）
# - trigram_only: 固有名詞/型番の拾い上げ（ノイズも増えやすい）
# - recent_only: 直近性の拾い上げ（弱い一致が増えやすい/なくてもOK）
retrieval_quota_assoc_state_percent = 20
retrieval_quota_assoc_multi_hit_percent = 40
retrieval_quota_assoc_vector_only_percent = 15
retrieval_quota_assoc_context_only_percent = 10
retrieval_quota_assoc_trigram_only_percent = 5
retrieval_quota_assoc_recent_only_percent = 0

# targeted_broad / explicit_about_time（昔話/期間指定）
# - about_time_only: 年/ライフステージのヒント検索で当たった候補（全期間モードで厚めにする）
retrieval_quota_broad_state_percent = 20
retrieval_quota_broad_multi_hit_percent = 30
retrieval_quota_broad_about_time_only_percent = 20
retrieval_quota_broad_vector_only_percent = 10
retrieval_quota_broad_context_only_percent = 5
retrieval_quota_broad_trigram_only_percent = 5

# LLM送受信ログの最大文字数（ターミナル/ファイル, 整形の空白含む）
llm_log_console_max_chars = 2000
llm_log_file_max_chars = 20000

# LLM送受信ログの各Value最大文字数（JSON向け、0で無効,  整形の空白含む）
llm_log_console_value_max_chars = 500
llm_log_file_value_max_chars = 60000

# LLMログのファイル出力
log_file_enabled = true
log_file_path = "logs/cocoro_ghost.log"
# ログファイルのローテーションサイズ（bytes）。例: 200KB = 200000
log_file_max_bytes = 2000000
